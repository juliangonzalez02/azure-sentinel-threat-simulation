id: 006-wmi-process-creation
name:  WMI Remote Process Creation
description: Detects processes spawned by WMI (wmiprvse.exe parent) which can indicate remote code execution via WMI. 
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: AzureMonitorWindowsAgents
    dataTypes: [SecurityEvent]
tactics: [LateralMovement, Execution]
techniques: [T1047]
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
kind: Scheduled
query:  |-
  SysmonParsed
  | where EventID == 1
  | where ParentImage endswith "wmiprvse.exe"
  | project TimeGenerated, Computer, User, Image, CommandLine, ParentImage
version: 1.0.0
tags:
  - T1047
  - RemoteExecution
