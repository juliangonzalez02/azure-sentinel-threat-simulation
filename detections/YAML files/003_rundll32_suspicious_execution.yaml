id: 003-rundll32-suspicious-execution
name: Rundll32 Suspicious Script Execution
description: Detects LOLBin abuse where rundll32.exe launches script-based payloads or URL handlers instead of DLL exports.
severity: Medium
status: Available
requiredDataConnectors: 
  - connectorId: AzureMonitorWindowsAgents
    dataTypes: [SecurityEvent]
tactics: [DefenseEvasion, Execution]
techniques: [T1218.011]
queryFrequency: 1h
queryPeriod: 1h
triggerOperator:  gt
triggerThreshold: 0
kind: Scheduled
query: |-
  SysmonParsed
  | where EventID == 1
  | where Image endswith "rundll32.exe"
  | where CommandLine has_any (".js", ".vbs", "url.dll", "javascript:", "vbscript:")
  | project TimeGenerated, Computer, User, Image, CommandLine, ParentImage
version: 1.0.0
tags:
  - T1218.011
  - LOLBin
